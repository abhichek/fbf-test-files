<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>List of Files</title>
    <!-- Load React and ReactDOM from CDN -->
    <script
      src="https://unpkg.com/react@17/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"
      crossorigin
    ></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      h1,
      h2 {
        color: #333;
      }
      ul {
        list-style-type: none;
        padding: 0;
      }
      li {
        margin: 10px 0;
        display: flex;
        align-items: center;
      }
      button {
        margin-left: 10px;
        cursor: pointer;
      }
      button:hover {
        background-color: #f0f0f0;
      }
      .group-title {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/javascript">
      const fileList = [
        {
          name: "AIRPORT-SYSTEMS-remove-paragraph.docx",
          url: "https://abhichek.github.io/fbf-test-files/AIRPORT-SYSTEMS-remove-paragraph.docx",
        },
        {
          name: "cleint2.xlsx",
          url: "https://abhichek.github.io/fbf-test-files/cleint2.xlsx",
        },
        {
          name: "client.docx",
          url: "https://abhichek.github.io/fbf-test-files/client.docx",
        },
        {
          name: "client.pdf",
          url: "https://abhichek.github.io/fbf-test-files/client.pdf",
        },
        {
          name: "client.xlsx",
          url: "https://abhichek.github.io/fbf-test-files/client.xlsx",
        },
        {
          name: "client2.docx",
          url: "https://abhichek.github.io/fbf-test-files/client2.docx",
        },
        {
          name: "client2.pdf",
          url: "https://abhichek.github.io/fbf-test-files/client2.pdf",
        },
        {
          name: "client3.pdf",
          url: "https://abhichek.github.io/fbf-test-files/client3.pdf",
        },
        {
          name: "COMECINC_LANDSCAPE_PROSPECTS-1711158335401 (2).docx",
          url: "https://abhichek.github.io/fbf-test-files/COMECINC_LANDSCAPE_PROSPECTS-1711158335401 (2).docx",
        },
        {
          name: "dictionary1-1714944622048.docx",
          url: "https://abhichek.github.io/fbf-test-files/dictionary1-1714944622048.docx",
        },
        {
          name: "HolyName_Hospital_Battered Women Resources.pdf",
          url: "https://abhichek.github.io/fbf-test-files/HolyName_Hospital_Battered Women Resources.pdf",
        },
        {
          name: "HolyName_Hospital_Food_Pantries_Soup_Kitchens_and_Food_Assistance_Programs.pdf",
          url: "https://abhichek.github.io/fbf-test-files/HolyName_Hospital_Food_Pantries_Soup_Kitchens_and_Food_Assistance_Programs.pdf",
        },
        {
          name: "HolyName_Hospital_LGBTQ+ Resources.pdf",
          url: "https://abhichek.github.io/fbf-test-files/HolyName_Hospital_LGBTQ+ Resources.pdf",
        },
        {
          name: "HolyName_Hospital_Women and Children Consult Checklist.pdf",
          url: "https://abhichek.github.io/fbf-test-files/HolyName_Hospital_Women and Children Consult Checklist.pdf",
        },
        {
          name: "HolyName_Meals on Wheels.pdf",
          url: "https://abhichek.github.io/fbf-test-files/HolyName_Meals on Wheels.pdf",
        },
        {
          name: "Inside-out-spacetime_Blackhole.V2.pdf",
          url: "https://abhichek.github.io/fbf-test-files/Inside-out-spacetime_Blackhole.V2.pdf",
        },
        {
          name: "JOSH_KAUFMAN_-_Le_personal_MBA_-_libgen.li-1714403646600.pdf",
          url: "https://abhichek.github.io/fbf-test-files/JOSH_KAUFMAN_-_Le_personal_MBA_-_libgen.li-1714403646600.pdf",
        },
        {
          name: "KJVdarkmodeBible-1714986979792.docx",
          url: "https://abhichek.github.io/fbf-test-files/KJVdarkmodeBible-1714986979792.docx",
        },
        {
          name: "multiexample.xlsx",
          url: "https://abhichek.github.io/fbf-test-files/multiexample.xlsx",
        },
        {
          name: "ocr-brochure.pdf",
          url: "https://abhichek.github.io/fbf-test-files/ocr-brochure.pdf",
        },
        {
          name: "ocr2.pdf",
          url: "https://abhichek.github.io/fbf-test-files/ocr2.pdf",
        },
        {
          name: "Questionnaire_Perinatal Services BC Edinburgh Perinatal_Postnatal Depression Scale (EPDS).pdf",
          url: "https://abhichek.github.io/fbf-test-files/Questionnaire_Perinatal Services BC Edinburgh Perinatal_Postnatal Depression Scale (EPDS).pdf",
        },
        {
          name: "Sites with Research Treatment Records-2024-05-02-15-31-57 (1).xlsx",
          url: "https://abhichek.github.io/fbf-test-files/Sites with Research Treatment Records-2024-05-02-15-31-57 (1).xlsx",
        },
        {
          name: "small-sample.docx",
          url: "https://abhichek.github.io/fbf-test-files/small-sample.docx",
        },
        {
          name: "Social Service Resources.pdf",
          url: "https://abhichek.github.io/fbf-test-files/Social Service Resources.pdf",
        },
        {
          name: "Solterra_Resort_Amenities-1714714410477 (1).pdf",
          url: "https://abhichek.github.io/fbf-test-files/Solterra_Resort_Amenities-1714714410477 (1).pdf",
        },
        {
          name: "TestOCR.pdf",
          url: "https://abhichek.github.io/fbf-test-files/TestOCR.pdf",
        },
        {
          name: "text-brochure.pdf",
          url: "https://abhichek.github.io/fbf-test-files/text-brochure.pdf",
        },
        {
          name: "ToPDF.pdf",
          url: "https://abhichek.github.io/fbf-test-files/ToPDF.pdf",
        },
        {
          name: "WSR_Comet_Rocks_-_28th_June_24_page-0002.pdf",
          url: "https://abhichek.github.io/fbf-test-files/WSR_Comet_Rocks_-_28th_June_24_page-0002.pdf",
        },
      ];

      const SIZE_THRESHOLD = {
        small: 5 * 1024 * 1024,
        medium: 20 * 1024 * 1024,
      }; // 5MB and 20MB in bytes

      // React Component
      const FileList = () => {
        const [groupedFiles, setGroupedFiles] = React.useState({
          small: [],
          medium: [],
          large: [],
        });
        const [loading, setLoading] = React.useState(true);

        // Fetch file sizes and group them
        React.useEffect(() => {
          const fetchFileSizes = async () => {
            const sizeGroups = { small: [], medium: [], large: [] };
            const batchSize = 15;

            // Process files in batches of 15
            for (let i = 0; i < fileList.length; i += batchSize) {
              const batch = fileList.slice(i, i + batchSize);
              
              const batchPromises = batch.map(async (file) => {
                try {
                  const response = await fetch(file.url, { method: "HEAD" });
                  const size = parseInt(
                    response.headers.get("Content-Length"),
                    10
                  );

                  if (size < SIZE_THRESHOLD.small) {
                    sizeGroups.small.push({ ...file, size });
                  } else if (size < SIZE_THRESHOLD.medium) {
                    sizeGroups.medium.push({ ...file, size });
                  } else {
                    sizeGroups.large.push({ ...file, size });
                  }
                } catch (err) {
                  console.error(`Failed to fetch size for ${file.name}`, err);
                  sizeGroups.small.push({ ...file, size: "Unknown" });
                }
              });

              // Wait for current batch to complete before processing next batch
              await Promise.all(batchPromises);
            }

            setGroupedFiles(sizeGroups);
            setLoading(false);
          };

          fetchFileSizes();
        }, []);

        // Function to copy URL to clipboard
        const copyToClipboard = (url) => {
          navigator.clipboard
            .writeText(url)
            .then(() => {
              alert("Copied to clipboard: " + url);
            })
            .catch((err) => console.error("Failed to copy URL", err));
        };

        const renderGroup = (group, title) => (
          <>
            <h2 className="group-title">{title}</h2>
            <ul>
              {group.map((file, index) => (
                <li key={index}>
                  <a href={file.url} target="_blank" rel="noopener noreferrer">
                    {file.name} (
                    {file.size !== "Unknown"
                      ? (file.size / 1024 / 1024).toFixed(2) + " MB"
                      : "Size Unknown"}
                    )
                  </a>
                  <button onClick={() => copyToClipboard(file.url)}>
                    Copy
                  </button>
                </li>
              ))}
            </ul>
          </>
        );

        if (loading)
          return React.createElement("div", null, "Loading file sizes...");

        return React.createElement(
          "div",
          null,
          React.createElement("h1", null, "List of Files"),
          renderGroup(groupedFiles.small, "Small Files (< 5 MB)"),
          renderGroup(groupedFiles.medium, "Medium Files (5 MB - 20 MB)"),
          renderGroup(groupedFiles.large, "Large Files (>= 20 MB)")
        );
      };

      // Render the component once the DOM content is loaded
      document.addEventListener("DOMContentLoaded", function () {
        ReactDOM.render(
          React.createElement(FileList),
          document.getElementById("root")
        );
      });
    </script>
  </body>
</html>
